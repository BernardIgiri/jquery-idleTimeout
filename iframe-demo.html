<!DOCTYPE html>
<html>

  <head>
    <meta http-equiv="X-UA-Compatible" content="text/html; charset=UTF-8" />
    <title>Jquery-idleTimeout - Demo Page - by JillElaine</title>

    <link type="text/css" rel="stylesheet" href="stylesheets/main.css"/>
    <link type="text/css" rel="stylesheet" href="stylesheets/jquery-ui.css"/>
    <link type="text/css" rel="stylesheet" href="stylesheets/jquery-ui.structure.css"/>
    <link type="text/css" rel="stylesheet" href="stylesheets/jquery-ui.theme.css"/>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" type="text/javascript"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js" type="text/javascript"></script>
    <script src="javascripts/store.min.js" type="text/javascript"></script>
    <script src="javascripts/jquery-idleTimeout-iframes.js" type="text/javascript"></script>

    <script type="text/javascript" charset="utf-8">
      /*global $: false, jQuery: false, document: false, store: false*/
      /*jslint indent: 2, sloppy: true*/

      $(document).ready(function () {

	$(document).idleTimeout({
	  idleTimeLimit: 15,            // 15 seconds 'No activity' time limit in seconds.
	  redirectUrl: 'https://github.com/JillElaine/jquery-idleTimeout',       // redirect to this url
	  activityEvents: 'click keypress scroll wheel mousewheel',    // separate each event with a space
	  dialogDisplayLimit: 30,       // Time to display the warning dialog before logout (and optional callback) in seconds
	  sessionKeepAliveTimer: false  // Set to false to disable pings.
	});

      });
    </script>
  </head>

  <body>
    <div>
      <div class="main_banner">
	<h1>Jquery-idleTimeout - iFrame & Dialog Demonstrations - by JillElaine</h1>
      </div>

      <div class="main_content">

	<h2>GitHub Project Page - <a href="https://github.com/JillElaine/jquery-idleTimeout">https://github.com/JillElaine/jquery-idleTimeout</a></h2>
	
	<h3>Functions across multiple windows, tabs <strong>AND IFRAMES</strong> within the same domain</h3>
	
	<h3>Demonstrations on this Page</h3>
	  <ul>
	    <li>The 'bubbling' of activity events from 'same domain' iframes to the parent page.</li>
	    <li>The detection of activity events within dynamic JQuery UI Dialogs, with and without 'same domain' iframes, both modal and non-modal.</li>
	    <li>The detection of activity events within dynamic non-iframe dom elements such as divs.</li>
	    <li>The 'bubbling' of activity events within dynamic 'same domain' iframes inserted into the body of the document. Iframes inserted via javascript to the <strong>body of the document require special handling</strong>: manually call the 'iframe recheck' function. Add this snippet to the function which inserts the iframe: <strong>$.fn.idleTimeout().iframeRecheck();</strong></li>
	  </ul>
	    
	  <p>Activity events detected, as configured by the idle-Timeout setup on this demonstration page, are clicks, keypresses, and wheel scrolls. To see the 'idle timeout' functionality, do not press any keys, click your mouse or scroll your mousewheel for <strong>15 seconds</strong>.</p>
	  
	  <p><strong>Remember, activity within iframes that are <strong>NOT</strong> from the same domain as the parent page CANNOT be detected.</strong></p>

	<!-- Basic Iframes Demonstration -->

	<h2>Basic Iframes Demonstrations</h2>
	  <ul>
	    <li>Activity within the iframe on the left is detected because the 'child' page within the iframe is from the <strong><i>same domain</i></strong> as the parent page.</li>
	    <li>Activity within the iframe on the right is <strong>NOT</strong> detected because the 'child' page within the iframe is from a <strong><i>different domain</i></strong>, w3schools.com.</li>
	    <li>The idleTimeout plugin attachs an 'event listener' to 'same domain' iframes. The listener enables activity events within the iframe to 'bubble' to the parent page.</li>
	 </ul>
	 
	 <table>
	  <tr>
	    <td>	      
	      <iframe src="iframe-demo-child.html" class="borderize height200">
	      </iframe>
	    </td>
	    <td>
	      <iframe src="http://w3schools.com/" class="borderize height200">
	      </iframe>
	    </td>
	  </tr>
	 </table>
 
	<div id="activity" class="borderize activity_detected"><p>I shake when activity is detected.</p></div>
	
	<!-- New Dialog Demonstrations -->
	
	<h2>New Dialog Demonstrations</h2>
	  <ul>
	    <li>This demonstration includes examples of both modal and non-modal dialogs, with and without iframes within the dialog.</li>
	    <li>Activity is detected within new dialogs without iframes. The idleTimeout plugin 'listens' for the opening of dialogs and, if the dialog includes an iframe, an 'event listener' is added to the iframe.</li>
	  </ul>
	  
	 <table>
	  <tr>
	    <td>
	      <h3>New Iframe Dialog - Non-Modal</h3>
	      <input type="button" value="Open New Iframe Dialog" onclick="dialogIframe.dialog('open')" class="button add left">

	      <div id="dialog-iframe" title="Iframe Dialog"></div>
	    </td>
	    <td>
	      <h3>New Form Dialog - Modal</h3>
	      <input type="button" value="Open Form Dialog" onclick="dialogForm.dialog('open')" class="button add left">

	      <div id="dialog-form" title="Form Dialog">
		<p>This is a demonstration of a modal dialog form with no iframe.</p>
		<form>
		  <fieldset>
		    <label for="name">Name</label>
		    <input type="text" name="name" id="name" value="Jane Smith" class="text ui-widget-content ui-corner-all">
		    <label for="email">Email</label>
		    <input type="text" name="email" id="email" value="jane@smith.com" class="text ui-widget-content ui-corner-all">
		    <label for="password">Password</label>
		    <input type="password" name="password" id="password" value="xxxxxxx" class="text ui-widget-content ui-corner-all">
		    <!-- Allow form submission with keyboard without duplicating the dialog button -->
		    <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
		  </fieldset>
		</form>
	      </div>
	    </td>
	  </tr>
	 </table>
	
	<!-- New Inserted Dom Div & Iframe Elements Demonstrations -->
	
	<h2>New Inserted Dom Elements Demonstrations</h2>
	  <p>Examples of dynamic div insertion & dynamic iframes, both same domain and other domain.</p>
	  
	<!-- New Inserted Divs Demonstrations -->
	
	<h3>New Div Insertion</h3>
	  <input id="new-div" type="button" value="Insert New Div After" onclick='$("#new-div").after("<div class=\"borderize\"><p>Newly Inserted Div (Dom Element)</p><p>Activity within this new div is detected.</p></div>")' class="button add left">
	  
	<!-- New Inserted Iframes Demonstration -->
	
	 <table>
	  <tr>
	    <td>
	      <h3>New Iframe Insertion - Same Domain</h3>
	      <input type="button" value="Insert New Iframe - Same Domain" onclick='$("#new-iframe-same-domain").append("<iframe src=\"iframe-body-child.html\" class=\"borderize height200\"></iframe>");$.fn.idleTimeout().iframeRecheck();' class="button add left">
	      <div id="new-iframe-same-domain"></div>
	    </td>
	    <td>
	      <h3>New Iframe Insertion - Other Domain</h3>
	      <input type="button" value="Insert New Iframe - Other Domain" onclick='$("#new-iframe-other-domain").html("<iframe src=\"http://w3schools.com\" class=\"borderize height200\"></iframe>");$.fn.idleTimeout().iframeRecheck();' class="button add left">
	      <div id="new-iframe-other-domain"></div>
	    </td>
	  </tr>
	 </table>

      </div>
    </div>
  </body>
  
  <script>
    /**
    * Dynamic Dialogs
    *
    **/
    
    var dialogIframe
    $(function () {
      dialogIframe = $("#dialog-iframe").dialog({
	autoOpen: false,
	height: 300,
	width: 350,
	modal: false,
	buttons: [{
	  text: "Click It",
	  click: function () {
	    // non-functioning button
	  }
	},
	{
	  text: "Cancel-Close",
	  click: function () {
	    dialogIframe.dialog("close");
	  }
	}],
      open: function () {
	dialogIframe.append('<iframe src="iframe-dialog-child.html" class="borderize height200"></iframe>');
      }
      });
    });

    var dialogForm
    $(function () {
      var form,
	// From http://www.whatwg.org/specs/web-apps/current-work/multipage/states-of-the-type-attribute.html#e-mail-state-%28type=email%29
	emailRegex = /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,
	name = $("#name"),
	email = $("#email"),
	password = $("#password"),
	allFields = $([]).add(name).add(email).add(password),
	tips = $(".validateTips");
      function updateTips(t) {
	tips
	.text(t)
	.addClass("ui-state-highlight");
	setTimeout(function() {
	  tips.removeClass("ui-state-highlight", 1500);
	}, 500 );
      }
      function checkLength(o, n, min, max) {
	if (o.val().length > max || o.val().length < min) {
	  o.addClass("ui-state-error");
	  updateTips("Length of " + n + " must be between " +
	  min + " and " + max + ".");
	  return false;
	} else {
	  return true;
	}
      }
      function checkRegexp(o, regexp, n) {
	if (!(regexp.test( o.val()))) {
	  o.addClass("ui-state-error");
	  updateTips(n);
	  return false;
	} else {
	  return true;
	}
      }
      function addUser() {
	var valid = true;
	allFields.removeClass("ui-state-error");
	valid = valid && checkLength(name, "username", 3, 16);
	valid = valid && checkLength(email, "email", 6, 80);
	valid = valid && checkLength(password, "password", 5, 16);
	valid = valid && checkRegexp(name, /^[a-z]([0-9a-z_\s])+$/i, "Username may consist of a-z, 0-9, underscores, spaces and must begin with a letter.");
	valid = valid && checkRegexp(email, emailRegex, "eg. ui@jquery.com");
	valid = valid && checkRegexp(password, /^([0-9a-zA-Z])+$/, "Password field only allow : a-z 0-9");
	if (valid) {
	  $("#users tbody").append("<tr>" +
	  "<td>" + name.val() + "</td>" +
	  "<td>" + email.val() + "</td>" +
	  "<td>" + password.val() + "</td>" +
	  "</tr>");
	  dialogForm.dialog("close");
	}
	return valid;
      }
      
      dialogForm = $("#dialog-form").dialog({
	autoOpen: false,
	height: 300,
	width: 350,
	modal: true,
	buttons: [{
	  text: "Submit",
	  click: function () {
	    dialogForm.dialog( "close" );
	  }
	},
	{
	  text: "Cancel-Close",
	  click: function () {
	    dialogForm.dialog( "close" );
	  }
	}],
	close: function() {
	  form[0].reset();
	  allFields.removeClass("ui-state-error");
	}
      });
      
      form = dialogForm.find("form").on("submit", function(event) {
	event.preventDefault();
	addUser();
      });

    });
  </script>
</html>