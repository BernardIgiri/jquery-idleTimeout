(function(c){c.fn.idleTimeout=function(p){var a=c.extend({idleTimeLimit:12E5,dialogDisplayLimit:18E4,redirectUrl:"/logout",customCallback:!1,activityEvents:"click keypress scroll wheel mousewheel mousemove",dialogTitle:"Session Expiration Warning",dialogText:"Because you have been inactive, your session is about to expire.",sessionKeepAliveTimer:6E4,sessionKeepAliveUrl:"/"},p),m,f,g,b,q=document.title,s=function(){c("<div id='idletimer_warning_dialog'><p>"+a.dialogText+"</p><p style='display:inline'>Time remaining: <div style='display:inline' id='countdownDisplay'></div></p></div>").dialog({buttons:{"Stay Logged In":function(){n(); clearInterval(f);clearInterval(g);h()},"Log Out Now":function(){k()}},closeOnEscape:!1,modal:!0,title:a.dialogTitle});c(".ui-dialog-titlebar-close").css("display","none");r();document.title=a.dialogTitle},l=function(){return!0===c("#idletimer_warning_dialog").dialog("isOpen")?!0:!1},r=function(){var e=a.dialogDisplayLimit/1E3,d,b;g=setInterval(function(){d=Math.floor(e/60);10>d&&(d="0"+d);b=e-60*d;10>b&&(b="0"+b);c("#countdownDisplay").html(d+":"+b);e-=1},1E3)},n=function(){c(".ui-dialog-content").dialog("destroy").remove(); document.title=q},u=function(){var b=c.now(),d=store.get("idleTimerLastActivity")+a.idleTimeLimit;b>d?!0!==l()&&(s(),f=setInterval(t,2E3)):!0===store.get("idleTimerLoggedOut")?k():!0===l()&&(n(),clearInterval(f),clearInterval(g))},h=function(){clearInterval(m);b=c.now();store.set("idleTimerLastActivity",b);m=setInterval(u,2E3)},t=function(){var b=c.now(),d=store.get("idleTimerLastActivity")+a.idleTimeLimit+a.dialogDisplayLimit;(b>d||!0===store.get("idleTimerLoggedOut"))&&k()},k=function(){store.set("idleTimerLoggedOut", !0);a.customCallback&&a.customCallback();a.redirectUrl&&(window.location.href=a.redirectUrl)},v=function(){c("body").on(a.activityEvents,function(){!0!==l()&&h()})},w=function(){a.sessionKeepAliveTimer&&setInterval(function(){b===store.get("idleTimerLastActivity")&&c.get(a.sessionKeepAliveUrl)},a.sessionKeepAliveTimer)};return this.each(function(){store.enabled?(b=c.now(),store.set("idleTimerLastActivity",b),store.set("idleTimerLoggedOut",!1)):alert("Dependent file missing. Please see: https://github.com/marcuswestin/store.js"); v();w();h()})}})(jQuery);